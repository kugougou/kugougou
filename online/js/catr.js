"use strict";!function(){if(jscookie.get("cookiesid")&&jscookie.get("cookienum")){var s=jscookie.get("cookiesid").split(","),c=jscookie.get("cookienum").split(",");$.each(s,function(e,i){var t,n;t=s[e],n=c[e],$.ajax({url:"http://localhost/PHP/project/php/xiangqing.php",dataType:"json"}).done(function(e){$.each(e,function(e,i){if(t==i.sid){var s=$(".list_message:hidden").clone(!0,!0);s.find("img").attr("src",i.url),s.find("img").attr("sid",i.sid),s.find(".comm_message").html(i.title),s.find(".pirce_message").html(i.price),s.find(".btn_message").find("input").val(n),s.find(".figure_message").html(i.price),s.find(".figure_message").html((i.price*n).toFixed(2)),s.css("display","block"),$(".catrmessage").append(s)}}),o()})})}function o(){var s=0;$(".message_w").find(".list_message").each(function(e,i){$(i).find(":checkbox").prop("checked")&&(s+=parseFloat($(i).find(".figure_message").html()))}),$(".pirce_total").html(s)}$(".checked_total").on("change",function(){$(".list_message:visible").find(":checkbox").prop("checked",$(this).prop("checked")),$(".checked_total").prop("checked",$(this).prop("checked")),o()});var e=$(".list_message:visible").find(":checkbox");function i(e){return parseFloat(e.parents(".list_message").find(".pirce_message").html())*parseInt(e.parents(".list_message").find("#inp_num").val())}$(".catrmessage").on("change",e,function(){$(".list_message:visible").find(":checkbox").size()===$(".list_message:visible").find("input:checked").size()?$(".checked_total").prop("checked",!0):$(".checked_total").prop("checked",!1),o()}),$("#rightBtn").on("click",function(){var e=$(this).parents(".list_message").find(".btn_message input").val();e++,console.log(e),$(this).parents(".list_message").find("#inp_num").val(e),$(this).parents(".list_message").find(".figure_message").html(i($(this))),o(),t($(this))}),$("#inp_num").on("click",function(){var e=$(this).val();/^\d$/g.test(e)||$(this).val(1),$(this).parents(".list_message").find(".figure_message").html(i($(this))),o(),t($(this))}),$("#leftBtn").on("click",function(){var e=$(this).parents(".list_message").find(".btn_message input").val();--e<=1&&(e=1),$(this).parents(".list_message").find("#inp_num").val(e),$(this).parents(".list_message").find(".figure_message").html(i($(this))),o(),t($(this))});var n=[],a=[];function l(){a=jscookie.get("cookiesid")&&jscookie.get("cookienum")?(n=jscookie.get("cookiesid").split(","),jscookie.get("cookienum").split(",")):(n=[],[])}function t(e){l();var i=e.parents(".list_message").find("img").attr("sid");a[$.inArray(i,n)]=e.parents(".list_message").find("#inp_num").val(),jscookie.add("cookienum",a,7)}$(".handle_message").on("click",function(){var s,e,t;l(),window.confirm("你确定删除?")&&($(this).parents(".list_message").remove(),s=$(this).parents(".list_message").find("img").attr("sid"),e=n,t=-1,$.each(e,function(e,i){s===i&&(t=e)}),e.splice(t,1),a.splice(t,1),jscookie.add("cookiesid",e,10),jscookie.add("cookienum",a,10),o())});var r=jscookie.get("num");1<=r&&($(".cart_num").show(),$(".cart_num").html(r)),void 0!==jscookie.get("user")?($(".mr_hear").hide(),$(".cg_hear").show(),$("#login_cg").html(jscookie.get("user"))):($(".mr_hear").show(),$(".cg_hear").hide()),$("#tuichu").on("click",function(){$(".mr_hear").show(),$(".cg_hear").hide(),jscookie.del("user")}),$(".db_index").on("click",function(){$("html").animate({scrollTop:0})})}();